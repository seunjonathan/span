{
	"name": "Towworksv2 Union Views",
	"properties": {
		"content": {
			"query": "IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = 'silver')\nBEGIN\n    CREATE DATABASE [silver]\nEND\nGO\n\nUSE silver\nGO\n\nCREATE OR ALTER VIEW [towworks].[vw_FastTrack_EVENTS] AS\nWITH CTE AS(\nSELECT EventGuid,\nCustomerGuid,\nBillingCompanyGuid,\nAction,\nByAssetGuid,\nByAssetName,\nCargoQuantity,\nOrderLineNumber,\nTowOrderLineNumber,\nLastChangedDate,\nCreatedDate,\nBillableHours,\nBillableQuantity,\nCostHours,\nCargoEventQuantity,\nFromWaterWay,\nFromWaterWayMile,\nLastChangedBy,\nmarked_as_deleted,\nStartTime,\nEndTime,\nWillCreateEventTypeGuid,\nWillCreateEventTypeName,\nTransactionsExpected,\nCreatedBy,\nToLcationGuid,\nFromWaterwayGuid,\nRateSchedule,\nFleetSchedule,\nByVendorGuid,\nByVendorName,\nQuotedRate,\nIsOpenEndedEvent,\nLubeOnBoard,\nLubeUsed,\nLubePurchased,\nSlopOil,\nGearOil,\nOilyWater,\nWorkOrderType,\nTaskType,\nDirection,\nFuelOnBoard,\nFuelUsed,\nFuelPurchased,\nLinkedEventGuid,\nOrderNumber,\nOrderType,\nTowOrderNumber,\nWorkOrderNumber,\nWORKORDERGUID,\nCustomerName,\nContractNumber,\nLogisticsOrderGuid,\nLogisticsOrderLineGuid,\nLinkedTaskGuid,\nLinkedWorkOrderGuid,\nToParentArea,\nToWaterwayGuid,\nToWaterWayName,\nToWaterWayMile,\nLoadStatus,\nCargoName,\nFromZone,\nFromParentArea,\nToLocation,\nToLocationShortName,\nToLocationPortName,\nToZone,\nToAssetGuid,\nToAssetName,\nFromLocationGuid,\nFromLocation,\nFromLocationShortName,\nFromLocationPortName,\nROW_NUMBER() OVER (PARTITION BY [EventGuid] ORDER BY (SELECT 1)) AS rn\nFROM [towworks].[vw_transient_FACT_EVENTS]\nUNION ALL\nSELECT \nEventGuid,\nCustomerGuid,\nBillingCompanyGuid,\nAction,\nByAssetGuid,\nByAssetName,\nCargoQuantity,\nOrderLineNumber,\nTowOrderLineNumber,\nLastChangedDate,\nCreatedDate,\nBillableHours,\nBillableQuantity,\nCostHours,\nCargoEventQuantity,\nFromWaterWay,\nFromWaterWayMile,\nLastChangedBy,\nmarked_as_deleted,\nStartTime,\nEndTime,\nWillCreateEventTypeGuid,\nWillCreateEventTypeName,\nTransactionsExpected,\nCreatedBy,\nToLcationGuid,\nFromWaterwayGuid,\nRateSchedule,\nFleetSchedule,\nByVendorGuid,\nByVendorName,\nQuotedRate,\nIsOpenEndedEvent,\nLubeOnBoard,\nLubeUsed,\nLubePurchased,\nSlopOil,\nGearOil,\nOilyWater,\nWorkOrderType,\nTaskType,\nDirection,\nFuelOnBoard,\nFuelUsed,\nFuelPurchased,\nLinkedEventGuid,\nOrderNumber,\nOrderType,\nTowOrderNumber,\nWorkOrderNumber,\nWORKORDERGUID,\nCustomerName,\nContractNumber,\nLogisticsOrderGuid,\nLogisticsOrderLineGuid,\nLinkedTaskGuid,\nLinkedWorkOrderGuid,\nToParentArea,\nToWaterwayGuid,\nToWaterWayName,\nToWaterWayMile,\nLoadStatus,\nCargoName,\nFromZone,\nFromParentArea,\nToLocation,\nToLocationShortName,\nToLocationPortName,\nToZone,\nToAssetGuid,\nToAssetName,\nFromLocationGuid,\nFromLocation,\nFromLocationShortName,\nFromLocationPortName,\nROW_NUMBER() OVER (PARTITION BY [EventGuid] ORDER BY (SELECT 1)) AS rn\nFROM [towworks].[vw_FACT_EVENTS] )\nSELECT \nEventGuid,\nCustomerGuid,\nBillingCompanyGuid,\nAction,\nByAssetGuid,\nByAssetName,\nCargoQuantity,\nOrderLineNumber,\nTowOrderLineNumber,\nLastChangedDate,\nCreatedDate,\nBillableHours,\nBillableQuantity,\nCostHours,\nCargoEventQuantity,\nFromWaterWay,\nFromWaterWayMile,\nLastChangedBy,\nmarked_as_deleted,\nStartTime,\nEndTime,\nWillCreateEventTypeGuid,\nWillCreateEventTypeName,\nTransactionsExpected,\nCreatedBy,\nToLcationGuid,\nFromWaterwayGuid,\nRateSchedule,\nFleetSchedule,\nByVendorGuid,\nByVendorName,\nQuotedRate,\nIsOpenEndedEvent,\nLubeOnBoard,\nLubeUsed,\nLubePurchased,\nSlopOil,\nGearOil,\nOilyWater,\nWorkOrderType,\nTaskType,\nDirection,\nFuelOnBoard,\nFuelUsed,\nFuelPurchased,\nLinkedEventGuid,\nOrderNumber,\nOrderType,\nTowOrderNumber,\nWorkOrderNumber,\nWORKORDERGUID,\nCustomerName,\nContractNumber,\nLogisticsOrderGuid,\nLogisticsOrderLineGuid,\nLinkedTaskGuid,\nLinkedWorkOrderGuid,\nToParentArea,\nToWaterwayGuid,\nToWaterWayName,\nToWaterWayMile,\nLoadStatus,\nCargoName,\nFromZone,\nFromParentArea,\nToLocation,\nToLocationShortName,\nToLocationPortName,\nToZone,\nToAssetGuid,\nToAssetName,\nFromLocationGuid,\nFromLocation,\nFromLocationShortName,\nFromLocationPortName\nFROM CTE\nwhere rn = 1;\nGO\n\nCREATE OR ALTER VIEW [towworks].[vw_FastTrack_WORKORDERS] AS\nWITH CTE AS(\nSELECT \nACKNOWLEDGEDBY,\nWORKTOLOCATIONGUID,\nWORKTOLOCATIONPORTNAME,\nWORKTOWATERWAYGUID,\nWORKWATERWAYGUID,\nWORKORDERNUMBERSORT,\nTANKERMANALLOWANCE,\nWORKTOWATERWAYMILE,\nESTIMATEDCOST,\nACTUALCOST,\nESTIMATEDREVENUE,\nACTUALREVENUE,\nMAXALLOWABLEDRAFT,\nESTIMATEDCOMPLETIONDATE,\nACTUALSTARTDATE,\nACTUALCOMPLETIONDATE,\nORDERTAKENDATE,\nREQUESTEDDATE,\nWORKWATERWAYMILE,\nCREATEDDATE,\nLASTCHANGEDDATE,\nACKNOWLEDGEDDATE,\nREQUESTEDSTARTDATE,\nREQUESTEDCOMPLETIONDATE,\nESTIMATEDSTARTDATE,\nBILLINGCOMPANYGUID,\nBILLINGCOMPANYNAME,\nBILLTOCUSTOMERGUID,\nBILLTOCUSTOMERNAME,\nBYASSETGUID,\nmarked_as_deleted,\nCARGOINSTRUCTIONS,\nCOMMERCIALAPPROVAL,\nCOMMODITYOWNERGUID,\nCOMMODITYOWNERGUID_NAME,\nCONSIGNEDTOGUID,\nAGENCYNAME,\nCONSIGNEDTOGUID_NAME,\nCONTRACTGUID,\nCOSTCENTER,\nCREATEDBY,\nEARLYCOMPLETION,\nBYASSETNAME,\nGLACCOUNT,\nHASOPENISSUES,\nEARLYSTART,\nEQUIPMENTINSTRUCTIONS,\nEQUIPMENTPREPCOMPLETE,\nEQUIPMENTPREPREQUIRED,\nINNAGE,\nLASTCHANGEDBY,\nLATECOMPLETION,\nLATESTART,\nEXTERNALREFERENCE,\nFIRMJOB,\nLIMITGUID,\nLINKEDISSUEGUID,\nLINKEDLOGISTICSLINEGUID,\nLOCATIONINSTRUCTIONS,\nORDERTAKENBY,\nHASOPENTASKS,\nREQUESTEDBY,\nOUTAGE,\nPARENTWORKORDERGUID,\nPRIORITYTYPEGUID,\nPRIORITYTYPENAME,\nPURCHASEORDERGUID,\nRESPONSIBLEPARTYTYPE,\nRESPONSIBLEPERSONGUID,\nPURCHASEORDERLINE,\nPURCHASEORDERLINEGUID,\nPURCHASEORDERNUMBER,\nRATESCHEDULE,\nTANKERMANALLOWANCEUOM,\nTERMSPAYMENT,\nTERTIARYASSETGUID,\nTERTIARYASSETNAME,\nRESPONSIBLEPARTYGUID,\nRESPONSIBLEPARTYNAME,\nTOASSETNAME,\nVENDORGUID,\nVENDORNAME,\nWORKLOCATIONGUID,\nWORKLOCATIONNAME,\nSAFETYINSTRUCTIONS,\nWORKORDERDESCRIPTION,\nWORKORDERGUID,\nWORKORDERINSTRUCTIONS,\nWORKORDERNOTES,\nWORKORDERNUMBER,\nTOASSETGUID,\nWORKORDERSTATUSDESCRIPTION,\nWORKORDERSTATUSGUID,\nWORKORDERSTATUSNAME,\nWORKORDERTYPEGUID,\nWORKORDERTYPENAME,\nWORKLOCATIONPORTNAME,\nROW_NUMBER() OVER (PARTITION BY [WORKORDERGUID] ORDER BY (SELECT 1)) AS rn\nFROM [towworks].[vw_transient_FACT_WORKORDERS]\nUNION ALL\nSELECT \nACKNOWLEDGEDBY,\nWORKTOLOCATIONGUID,\nWORKTOLOCATIONPORTNAME,\nWORKTOWATERWAYGUID,\nWORKWATERWAYGUID,\nWORKORDERNUMBERSORT,\nTANKERMANALLOWANCE,\nWORKTOWATERWAYMILE,\nESTIMATEDCOST,\nACTUALCOST,\nESTIMATEDREVENUE,\nACTUALREVENUE,\nMAXALLOWABLEDRAFT,\nESTIMATEDCOMPLETIONDATE,\nACTUALSTARTDATE,\nACTUALCOMPLETIONDATE,\nORDERTAKENDATE,\nREQUESTEDDATE,\nWORKWATERWAYMILE,\nCREATEDDATE,\nLASTCHANGEDDATE,\nACKNOWLEDGEDDATE,\nREQUESTEDSTARTDATE,\nREQUESTEDCOMPLETIONDATE,\nESTIMATEDSTARTDATE,\nBILLINGCOMPANYGUID,\nBILLINGCOMPANYNAME,\nBILLTOCUSTOMERGUID,\nBILLTOCUSTOMERNAME,\nBYASSETGUID,\nmarked_as_deleted,\nCARGOINSTRUCTIONS,\nCOMMERCIALAPPROVAL,\nCOMMODITYOWNERGUID,\nCOMMODITYOWNERGUID_NAME,\nCONSIGNEDTOGUID,\nAGENCYNAME,\nCONSIGNEDTOGUID_NAME,\nCONTRACTGUID,\nCOSTCENTER,\nCREATEDBY,\nEARLYCOMPLETION,\nBYASSETNAME,\nGLACCOUNT,\nHASOPENISSUES,\nEARLYSTART,\nEQUIPMENTINSTRUCTIONS,\nEQUIPMENTPREPCOMPLETE,\nEQUIPMENTPREPREQUIRED,\nINNAGE,\nLASTCHANGEDBY,\nLATECOMPLETION,\nLATESTART,\nEXTERNALREFERENCE,\nFIRMJOB,\nLIMITGUID,\nLINKEDISSUEGUID,\nLINKEDLOGISTICSLINEGUID,\nLOCATIONINSTRUCTIONS,\nORDERTAKENBY,\nHASOPENTASKS,\nREQUESTEDBY,\nOUTAGE,\nPARENTWORKORDERGUID,\nPRIORITYTYPEGUID,\nPRIORITYTYPENAME,\nPURCHASEORDERGUID,\nRESPONSIBLEPARTYTYPE,\nRESPONSIBLEPERSONGUID,\nPURCHASEORDERLINE,\nPURCHASEORDERLINEGUID,\nPURCHASEORDERNUMBER,\nRATESCHEDULE,\nTANKERMANALLOWANCEUOM,\nTERMSPAYMENT,\nTERTIARYASSETGUID,\nTERTIARYASSETNAME,\nRESPONSIBLEPARTYGUID,\nRESPONSIBLEPARTYNAME,\nTOASSETNAME,\nVENDORGUID,\nVENDORNAME,\nWORKLOCATIONGUID,\nWORKLOCATIONNAME,\nSAFETYINSTRUCTIONS,\nWORKORDERDESCRIPTION,\nWORKORDERGUID,\nWORKORDERINSTRUCTIONS,\nWORKORDERNOTES,\nWORKORDERNUMBER,\nTOASSETGUID,\nWORKORDERSTATUSDESCRIPTION,\nWORKORDERSTATUSGUID,\nWORKORDERSTATUSNAME,\nWORKORDERTYPEGUID,\nWORKORDERTYPENAME,\nWORKLOCATIONPORTNAME,\nROW_NUMBER() OVER (PARTITION BY [WORKORDERGUID] ORDER BY (SELECT 1)) AS rn\nFROM [towworks].[vw_FACT_WORKORDERS] )\nSELECT\nACKNOWLEDGEDBY,\nWORKTOLOCATIONGUID,\nWORKTOLOCATIONPORTNAME,\nWORKTOWATERWAYGUID,\nWORKWATERWAYGUID,\nWORKORDERNUMBERSORT,\nTANKERMANALLOWANCE,\nWORKTOWATERWAYMILE,\nESTIMATEDCOST,\nACTUALCOST,\nESTIMATEDREVENUE,\nACTUALREVENUE,\nMAXALLOWABLEDRAFT,\nESTIMATEDCOMPLETIONDATE,\nACTUALSTARTDATE,\nACTUALCOMPLETIONDATE,\nORDERTAKENDATE,\nREQUESTEDDATE,\nWORKWATERWAYMILE,\nCREATEDDATE,\nLASTCHANGEDDATE,\nACKNOWLEDGEDDATE,\nREQUESTEDSTARTDATE,\nREQUESTEDCOMPLETIONDATE,\nESTIMATEDSTARTDATE,\nBILLINGCOMPANYGUID,\nBILLINGCOMPANYNAME,\nBILLTOCUSTOMERGUID,\nBILLTOCUSTOMERNAME,\nBYASSETGUID,\nmarked_as_deleted,\nCARGOINSTRUCTIONS,\nCOMMERCIALAPPROVAL,\nCOMMODITYOWNERGUID,\nCOMMODITYOWNERGUID_NAME,\nCONSIGNEDTOGUID,\nAGENCYNAME,\nCONSIGNEDTOGUID_NAME,\nCONTRACTGUID,\nCOSTCENTER,\nCREATEDBY,\nEARLYCOMPLETION,\nBYASSETNAME,\nGLACCOUNT,\nHASOPENISSUES,\nEARLYSTART,\nEQUIPMENTINSTRUCTIONS,\nEQUIPMENTPREPCOMPLETE,\nEQUIPMENTPREPREQUIRED,\nINNAGE,\nLASTCHANGEDBY,\nLATECOMPLETION,\nLATESTART,\nEXTERNALREFERENCE,\nFIRMJOB,\nLIMITGUID,\nLINKEDISSUEGUID,\nLINKEDLOGISTICSLINEGUID,\nLOCATIONINSTRUCTIONS,\nORDERTAKENBY,\nHASOPENTASKS,\nREQUESTEDBY,\nOUTAGE,\nPARENTWORKORDERGUID,\nPRIORITYTYPEGUID,\nPRIORITYTYPENAME,\nPURCHASEORDERGUID,\nRESPONSIBLEPARTYTYPE,\nRESPONSIBLEPERSONGUID,\nPURCHASEORDERLINE,\nPURCHASEORDERLINEGUID,\nPURCHASEORDERNUMBER,\nRATESCHEDULE,\nTANKERMANALLOWANCEUOM,\nTERMSPAYMENT,\nTERTIARYASSETGUID,\nTERTIARYASSETNAME,\nRESPONSIBLEPARTYGUID,\nRESPONSIBLEPARTYNAME,\nTOASSETNAME,\nVENDORGUID,\nVENDORNAME,\nWORKLOCATIONGUID,\nWORKLOCATIONNAME,\nSAFETYINSTRUCTIONS,\nWORKORDERDESCRIPTION,\nWORKORDERGUID,\nWORKORDERINSTRUCTIONS,\nWORKORDERNOTES,\nWORKORDERNUMBER,\nTOASSETGUID,\nWORKORDERSTATUSDESCRIPTION,\nWORKORDERSTATUSGUID,\nWORKORDERSTATUSNAME,\nWORKORDERTYPEGUID,\nWORKORDERTYPENAME,\nWORKLOCATIONPORTNAME\nFROM CTE\nwhere rn = 1;\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "silver",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}