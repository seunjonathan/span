{
  "IsEncrypted": false,
  "Values": {
    "AzureWebJobsStorage": "UseDevelopmentStorage=true",
    "FUNCTIONS_WORKER_RUNTIME": "python",
    "ConnectionStringWOPWD": "DRIVER={ODBC Driver 17 for SQL Server};SERVER=van-ss-sql15ag.seaspan.com,1433;DATABASE=TOPSSEASPAN_PROD;Encrypt=yes;TrustServerCertificate=yes;Trusted_connection=no;UID=PowerBIReader_SMCBITeam;PWD=",
    "DBPassword": "@Microsoft.KeyVault(VaultName=kv-smg-dev;SecretName=TOPS-Password)",
    "SQLQuery_BOL": "WITH CTE_JobPK AS ( SELECT pk_Job_IN 'JobPK' FROM t_Job WHERE Added_dt > dateadd(ss,-300,getdate()) UNION SELECT fk_Job_in FROM t_JobFieldUpdated WHERE DateTime_dt > dateadd(ss,-300,getdate()) ) SELECT job.JobNumber_vc 'BOL_Number' , assignment.pk_Assignment_in 'Sailing_ID' , job.fk_ContainerType_in 'Container_Type' , trunk.fk_AssignmentStatus_in 'Assignment_Status' , jobsummary.Hazardous_bt 'Hazardous_Goods' , job.OOGLength_dc 'Trailer_Length' , job.OverlengthFront_dc 'Trailer_Overhang_Front' , job.OverlengthBack_dc 'Trailer_Overhang_Back' , DATEADD(dd, 2, otgpod.PODDate_dt + otgpod.PODTime_dt) 'Signature_Date_Time' , CASE WHEN trunk.fk_AssignmentStatus_in = 2 AND DATEADD(dd, 2, DATEADD(dd, 0, DATEDIFF(dd, 0, waypoint.DepartureDate_dt)) + waypoint.DepartureTime_dt) IS NULL THEN trunk.LastDoneStatus_dt WHEN trunk.fk_AssignmentStatus_in = 2 AND DATEADD(dd, 2, DATEADD(dd, 0, DATEDIFF(dd, 0, waypoint.DepartureDate_dt)) + waypoint.DepartureTime_dt) IS NOT NULL THEN DATEADD(dd, 2, DATEADD(dd, 0, DATEDIFF(dd, 0, waypoint.DepartureDate_dt)) + waypoint.DepartureTime_dt) ELSE NULL END AS Actual_Picked_Up_Date_Time , job.fk_Route_in 'Route' , job.fk_JobCategory_in 'Category' , job.Added_dt 'Added_Date' , CASE WHEN DATEADD(dd, 2, appointment.EndDate_dt + appointment.EndTime_dt) > job.ShipmentDate_dt THEN DATEADD(hh, 60, appointment.EndDate_dt + appointment.EndTime_dt) ELSE job.ShipmentDate_dt END AS 'Preferred_Pickup_Date_Time_official' , job.ShipmentDate_dt AS 'Preferred_Pickup_Date_Time' , t_Consignment.Deleted_dt 'Deleted_Date' , job.[CustomFlag2_bt] 'DG_Authorized' , trunk.LastDoneStatus_dt 'Status' , job.pk_Job_in , t_Consignment.fk_Customer_in , job.fk_MovementMode_in , job.ContainerNumber_ch 'Unit_Number' , ISNULL( ( SELECT TOP 1 CASE WHEN [UsedReservationTEU_dc] =1 THEN 1 ELSE 0 END FROM [t_AssignmentReservationLog] subassreslog WHERE subassreslog.fk_Trunk_in = trunk.pk_Trunk_in AND subassreslog.fk_Assignment_in = assignment.pk_Assignment_in ORDER BY subassreslog.Added_dt desc ) ,0) 'Reservation_used_TEU' FROM t_Job job LEFT JOIN t_Trunk trunk ON job.pk_Job_in = trunk.fk_Job_in LEFT JOIN t_assignment assignment ON trunk.fk_Assignment_in = assignment.pk_Assignment_in LEFT JOIN t_JobSummary jobsummary ON jobsummary.fk_Job_in = job.pk_Job_in LEFT JOIN t_OTG_POD otgpod ON otgpod.fk_Trunk_in = trunk.pk_Trunk_in LEFT JOIN t_Waypoint waypoint ON waypoint.fk_Trunk_in = trunk.pk_Trunk_in AND waypoint.Order_si = 2 LEFT JOIN t_Consignment ON job.fk_Consignment_in = t_Consignment.pk_Consignment_in LEFT JOIN t_Appointment appointment ON assignment.fk_Appointment_in = appointment.pk_Appointment_in WHERE job.pk_Job_in IN ( SELECT JobPK from CTE_JobPK ) and job.Added_dt >= '2019-11-29 15:14:19.737'",
    "SQLQuery_Sailing": "SELECT Distinct  assignment.pk_Assignment_in 'Sailing_ID' ,dateadd(dd,2,appointment.StartDate_dt + appointment.StartTime_dt) 'Scheduled_Departure_Date_time'  ,assignment.DepartureTime_dt 'Actual_Departure_DateTime' , DATEDIFF(mi,assignment.DepartureTime_dt, dateadd(dd,2,appointment.StartDate_dt + appointment.StartTime_dt)) 'Departure_Variance'  , dateadd(dd,2,appointment.EstimatedEndDate_dt + appointment.EstimatedEndTime_dt) 'Scheduled_Arrival_Date_time' ,DATEADD(dd, 2, appointment.EndDate_dt + appointment.EndTime_dt) 'Actual_Arrival_DateTime' ,DATEDIFF(mi, dateadd(dd,2,appointment.EstimatedEndDate_dt + appointment.EstimatedEndTime_dt), DATEADD(dd, 2, appointment.EndDate_dt + appointment.EndTime_dt)) 'Arrival_Variance'  ,assignment.Added_dt 'Add_Date'  ,assignment.Deleted_dt 'Deleted_Date' , assignment.HaulierInformed_bt 'Lock_Sailing' ,assignment.fk_Truck_in  ,assignment.fk_route_in FROM t_Assignment assignment INNER JOIN t_Appointment appointment ON appointment.pk_Appointment_in = assignment.fk_Appointment_in INNER JOIN t_Assignment_MasterLog assignmentmasterlog ON assignment.pk_Assignment_in = assignmentmasterlog.fk_Assignment_in INNER JOIN t_MasterLog masterlog ON assignmentmasterlog.fk_MasterLog_in = masterlog.pk_MasterLog_in and masterlog.date_dt > dateadd(mm,-1,getdate())  WHERE masterlog.Date_dt > dateadd(ss,-300,getdate()) OR assignment.Added_dt > dateadd(ss,-300,getdate())",
    "SQLQuery_Location": "SELECT [pk_Truck_in] ,  'Vessel' as 'Location_Type' ,  CASE         WHEN                 truck.[TruckName_vc] ='Fraser Link'         THEN                 'Pusher'         ELSE                 truck.[TruckName_vc]         END AS 'Vessel_Name'         ,         (                 SELECT                         TOP 1 -1*(LEFT([Longitude_vc],CHARINDEX('''',[Longitude_vc])-1) + CONVERT(decimal(10,6),SUBSTRING([Longitude_vc], CHARINDEX('''',[Longitude_vc]) + 1, CHARINDEX('''',[Longitude_vc],CHARINDEX('''',[Longitude_vc])+1) - CHARINDEX('''',[Longitude_vc]) - 1))/60 + CONVERT(decimal(10,6),SUBSTRING(longitude_vc,CHARINDEX('''',Longitude_vc,CHARINDEX('''',longitude_vc,charindex('''',longitude_vc)+1))+1,len(longitude_vc)-CHARINDEX('''',Longitude_vc,CHARINDEX('''',longitude_vc,charindex('''',longitude_vc)+1))-1))/3600 )                 FROM                         t_DeviceTracking                 WHERE                         t_DeviceTracking.DeviceID_vc = truck.DataCaptureUnit_vc                 ORDER BY                         t_DeviceTracking.Date_dt desc,                         t_DeviceTracking.Time_dt desc) 'Longitude'         ,         (                 SELECT                         TOP 1 (LEFT([Latitude_vc],CHARINDEX('''',[Latitude_vc])-1) + CONVERT(decimal(10,6),SUBSTRING([Latitude_vc], CHARINDEX('''',[Latitude_vc]) + 1, CHARINDEX('''',[Latitude_vc],CHARINDEX('''',[Latitude_vc])+1) - CHARINDEX('''',[Latitude_vc]) - 1))/60) + CONVERT(decimal(10,6),SUBSTRING(latitude_vc,CHARINDEX('''',Latitude_vc,CHARINDEX('''',latitude_vc,charindex('''',latitude_vc)+1))+1,len(latitude_vc)-CHARINDEX('''',Latitude_vc,CHARINDEX('''',latitude_vc,charindex('''',latitude_vc)+1))-1))/3600 'Latitude'                 FROM                         t_DeviceTracking                 WHERE                         t_DeviceTracking.DeviceID_vc = truck.DataCaptureUnit_vc                 ORDER BY                         t_DeviceTracking.Date_dt desc             ,                         t_DeviceTracking.Time_dt desc) 'Latitude' ,         (                 SELECT                         TOP 1                         CASE                         WHEN                                 DATEDIFF(mi, DATEADD(dd,2,Date_dt + Time_dt), GETDATE())> 10                         THEN                                 0                         ELSE                                 SpeedKnots_dc                         END                 FROM                         t_DeviceTracking                 WHERE                         t_DeviceTracking.DeviceID_vc = truck.DataCaptureUnit_vc                 ORDER BY                         t_DeviceTracking.Date_dt desc          ,                         t_DeviceTracking.Time_dt desc) 'Knots' ,         (                 SELECT                         TOP 1 Heading_in                 FROM                         t_DeviceTracking                 WHERE                         t_DeviceTracking.DeviceID_vc = truck.DataCaptureUnit_vc                 ORDER BY                         t_DeviceTracking.Date_dt desc            ,                         t_DeviceTracking.Time_dt desc) 'Heading' ,         (                 SELECT                         TOP 1 DATEADD(dd,2,Date_dt + Time_dt)                 FROM                         t_DeviceTracking                 WHERE                         t_DeviceTracking.DeviceID_vc = truck.DataCaptureUnit_vc                 ORDER BY                         t_DeviceTracking.Date_dt desc,                         t_DeviceTracking.Time_dt desc) 'Date_Time' FROM         [t_Truck] truck WHERE         truck.Deleted_dt IS NULL AND     truck.DataCaptureUnit_vc IS NOT NULL AND     truck.DataCaptureUnit_vc <>'' AND     pk_Truck_in NOT IN (7,19)",
    "BOLFolder": "silver/TOPSv2/T_BOL",
    "SailingFolder": "silver/TOPSv2/T_SAILING",
    "LocationFolder": "silver/TOPSv2/T_LOCATION",
    "DeleteAfterSeconds": "7500",
    "Container": "transient",
    "StorageConnectionString": "@Microsoft.KeyVault(VaultName=kv-smg-dev;SecretName=ADLSSMG-ACCESSKEY)"
  }
}